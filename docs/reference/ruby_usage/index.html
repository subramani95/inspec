<!DOCTYPE html><html><head><meta content="IE=edge,chrome=1" http-equiv="X-UA-Compatible" /><meta charset="utf-8" /><meta content="width=device-width,initial-scale=1.0,minimum-scale=1.0,maximum-scale=1.0,user-scalable=no" name="viewport" /><link href="/favicon.png" rel="icon" type="image/png" /><link href="/favicon.ico" rel="icon" /><title>InSpec</title><meta name="description" /><link href="/css/inspec_tutorial.css" rel="stylesheet" type="text/css" /><link href="/stylesheets/vendor/fontawesome.min.css" rel="stylesheet" type="text/css" /><link href="/stylesheets/site.css" rel="stylesheet" /></head><body class="docs docs_reference docs_reference_ruby_usage docs_reference_ruby_usage_index"><script>gm_session_id = 'inspecGlobalMessage8';</script><div class="container"><nav class="shadow" id="main-nav"><progress value="0"></progress><div id="main-nav-ctas"><a class="main-nav--logo" href="/"><img alt="logo for InSpec" onerror="this.src='/images/inspec-by-chef-logo.png'" src="/images/inspec-by-chef-logo.svg" /></a><i class="fa fa-bars main-nav--toggle strict-right mobile-show"></i><ul class="main-nav--links"><li class="main-nav--link"><a href="/tutorials" class="link " <span class="main-nav--link-text">Tutorials</span></a></li><li class="main-nav--link"><a href="/docs" class="link " <span class="main-nav--link-text">Docs</span></a></li><li class="main-nav--link"><a href="/community" class="link " <span class="main-nav--link-text">Community</span></a></li><li class="main-nav--link"><a class="link" href="https://github.com/chef/inspec"><i class="fa fa-github"></i><span class="main-nav--link-text">Github</span></a></li><li class="nav-cta"><a class="button btn-sm btn-purple" href="/downloads"><i class="fa fa-cloud-download"></i>Download</a></li><li class="nav-cta mobile-hide"><a class="button btn-sm btn-purple-o" href="/demo">try demo</a></li></ul></div></nav><main id="main-content"><!--header search--><header class="bg-gradient margin-top-offset relative"><div class="row"><div class="columns large-12 medium-12 z-20"><div class="flex align margin-both"><form action="/docs/search/" class="main-sidebar--search shadow-dark" method="get"><input class="st-default-search-input" name="q" placeholder="Search documentation..." type="text" /></form><button action="/docs/search/" class="search shadow-dark margin-left-xs" method="get"><i class="fa fa-search t-white"></i></button></div></div></div><div id="particles-second"><canvas class="particles-js-canvas-el" /></div></header><div class="row margin-both relative"><column class="columns large-3 medium-3 mobile-hide" id="sidebar"><ul class="main-sidebar--links"><li class="main-sidebar--link"><small>Getting Started</small><ul class="main-sidebar--list no-bullet"><li class="main-sidebar--list--item--a"><a href="/docs">Overview</a><i class="fa fa-angle-double-right focus strict-right"></i></li><li class="main-sidebar--list--item--a"><a href="/downloads">Get InSpec</a><i class="fa fa-angle-double-right focus strict-right"></i></li><li class="main-sidebar--list--item--a"><a href="/docs/reference/platforms">InSpec for the cloud</a><i class="fa fa-angle-double-right focus strict-right"></i></li><li class="main-sidebar--list--item--a"><a href="/tutorials">Tutorials</a><i class="fa fa-angle-double-right focus strict-right"></i></li><li class="main-sidebar--list--item--a"><a href="/docs/reference/inspec_and_friends">InSpec and friends</a><i class="fa fa-angle-double-right focus strict-right"></i></li><li class="main-sidebar--list--item--a"><a href="/docs/reference/glossary">InSpec Glossary</a><i class="fa fa-angle-double-right focus strict-right"></i></li></ul></li><li class="main-sidebar--link"><small>Reference</small><ul class="main-sidebar--list no-bullet"><li class="main-sidebar--list--item--a"><a href="/docs/reference/cli">inspec executable</a><i class="fa fa-angle-double-right focus strict-right"></i></li><li class="main-sidebar--list--item--a"><a href="/docs/reference/profiles">Profiles</a><i class="fa fa-angle-double-right focus strict-right"></i></li><li class="main-sidebar--list--item--a"><a href="/docs/reference/resources">Resources</a><i class="fa fa-angle-double-right focus strict-right"></i></li><li class="main-sidebar--list--item--a"><a href="/docs/reference/matchers">Matchers</a><i class="fa fa-angle-double-right focus strict-right"></i></li><li class="main-sidebar--list--item--a"><a href="/docs/reference/reporters">Reporters</a><i class="fa fa-angle-double-right focus strict-right"></i></li><li class="main-sidebar--list--item--a"><a href="/docs/reference/dsl_inspec">InSpec DSL</a><i class="fa fa-angle-double-right focus strict-right"></i></li><li class="main-sidebar--list--item--a"><a href="/docs/reference/dsl_resource">Custom Resources</a><i class="fa fa-angle-double-right focus strict-right"></i></li><li class="main-sidebar--list--item--a"><a href="/docs/reference/plugin_kitchen_inspec">kitchen-inspec</a><i class="fa fa-angle-double-right focus strict-right"></i></li><li class="main-sidebar--list--item--a"><a href="/docs/reference/shell">inspec shell</a><i class="fa fa-angle-double-right focus strict-right"></i></li><li class="main-sidebar--list--item--a"><a href="/docs/reference/habitat">Habitat Integration</a><i class="fa fa-angle-double-right focus strict-right"></i></li><li class="main-sidebar--list--item--a t-purple"><a href="/docs/reference/ruby_usage">Ruby usage</a><i class="fa fa-angle-double-right focus strict-right"></i></li><li class="main-sidebar--list--item--a"><a href="/docs/reference/migration">Migration from Serverspec</a><i class="fa fa-angle-double-right focus strict-right"></i></li></ul></li></ul></column><column class="columns large-9 medium-9 mobile-12" id="mainbar"><h1 id="using-ruby-in-inspec">Using Ruby in InSpec</h1>

<p>The InSpec DSL is a Ruby based DSL for writing audit controls, which
includes audit resources that you can invoke. Core and custom resources
are written as regular Ruby classes which inherit from
<code>Inspec.resource</code>.</p>

<p>Assuming we have a JSON file like this on the node to be tested:</p>
<div class="highlight"><pre class="highlight json"><code><span class="p">{</span><span class="w">
  </span><span class="s2">"keys"</span><span class="p">:[</span><span class="w">
    </span><span class="p">{</span><span class="s2">"username"</span><span class="p">:</span><span class="s2">"john"</span><span class="p">,</span><span class="w"> </span><span class="s2">"key"</span><span class="p">:</span><span class="s2">"/opt/keys/johnd.key"</span><span class="p">},</span><span class="w">
    </span><span class="p">{</span><span class="s2">"username"</span><span class="p">:</span><span class="s2">"jane"</span><span class="p">,</span><span class="w"> </span><span class="s2">"key"</span><span class="p">:</span><span class="s2">"/opt/keys/janed.key"</span><span class="p">},</span><span class="w">
    </span><span class="p">{</span><span class="s2">"username"</span><span class="p">:</span><span class="s2">"sunny "</span><span class="p">,</span><span class="w"> </span><span class="s2">"key"</span><span class="p">:</span><span class="s2">"/opt/keys/sunnym.key"</span><span class="p">}</span><span class="w">
  </span><span class="p">]</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div>
<p>The following example shows how you can use pure Ruby code(variables,
loops, conditionals, regular expressions, etc) to run a few tests
against the above JSON file:</p>
<div class="highlight"><pre class="highlight ruby"><code><span class="n">control</span> <span class="s1">'check-interns'</span> <span class="k">do</span>
  <span class="c1"># use the json InSpec resource to get the file</span>
  <span class="n">json_obj</span> <span class="o">=</span> <span class="n">json</span><span class="p">(</span><span class="s1">'/opt/keys/interns.json'</span><span class="p">)</span>
  <span class="n">describe</span> <span class="n">json_obj</span> <span class="k">do</span>
    <span class="n">its</span><span class="p">(</span><span class="s1">'keys'</span><span class="p">)</span> <span class="p">{</span> <span class="n">should_not</span> <span class="n">eq</span> <span class="kp">nil</span> <span class="p">}</span>
  <span class="k">end</span>
  <span class="k">if</span> <span class="n">json_obj</span><span class="p">[</span><span class="s1">'keys'</span><span class="p">]</span>
    <span class="c1"># loop over the keys array</span>
    <span class="n">json_obj</span><span class="p">[</span><span class="s1">'keys'</span><span class="p">].</span><span class="nf">each</span> <span class="k">do</span> <span class="o">|</span><span class="n">intern</span><span class="o">|</span>
      <span class="n">username</span> <span class="o">=</span> <span class="n">intern</span><span class="p">[</span><span class="s1">'username'</span><span class="p">].</span><span class="nf">strip</span>
      <span class="c1"># check for white spaces chars in usernames</span>
      <span class="n">describe</span> <span class="n">username</span> <span class="k">do</span>
        <span class="n">it</span> <span class="p">{</span> <span class="n">should_not</span> <span class="n">match</span><span class="p">(</span><span class="sr">/\s/</span><span class="p">)</span> <span class="p">}</span>
      <span class="k">end</span>
      <span class="c1"># check key file owners and permissions</span>
      <span class="n">describe</span> <span class="n">file</span><span class="p">(</span><span class="n">intern</span><span class="p">[</span><span class="s1">'key'</span><span class="p">])</span> <span class="k">do</span>
        <span class="n">it</span> <span class="p">{</span> <span class="n">should</span> <span class="n">be_owned_by</span> <span class="n">username</span> <span class="p">}</span>
        <span class="n">its</span><span class="p">(</span><span class="s1">'mode'</span><span class="p">)</span> <span class="p">{</span> <span class="n">should</span> <span class="n">cmp</span> <span class="s1">'0600'</span> <span class="p">}</span>
      <span class="k">end</span>
    <span class="k">end</span>
  <span class="k">end</span>
<span class="k">end</span>
</code></pre></div>
<h2 id="execution">Execution</h2>

<p>It&rsquo;s important to understand that Ruby code used in custom resources and
controls DSL is executed on the system that runs InSpec. This allows
InSpec to work without Ruby and rubygems being required on remote
targets(servers or containers).</p>

<p>For example, using <code>`ls</code>` or <code>system(&#39;ls&#39;)</code> will result in the <code>ls</code>
command being run locally and not on the target(remote) system. In order
to process the output of <code>ls</code> executed on the target system, use
<code>inspec.command(&#39;ls&#39;)</code> or <code>inspec.powershell(&#39;ls&#39;)</code></p>

<p>Similarly, use <code>inspec.file(PATH)</code> to access files or directories from
remote systems in your tests or custom resources.</p>

<h2 id="using-rubygems">Using rubygems</h2>

<p>Ruby gems are self-contained programs and libraries. If you create a custom
resource please vendor gems into the library. This ensures that all resources
are self-contained and complete and don&rsquo;t need any resolution at runtime. We
vendor resources and requirements through dependency resolution, which is
independent of programming languages and their resolver mechanisms.</p>

<h2 id="interactive-debugging-with-pry">Interactive Debugging with Pry</h2>

<p>Here&rsquo;s a sample InSpec control that users Ruby variables to instantiate
an InSpec resource once and use the content in multiple tests.</p>
<div class="highlight"><pre class="highlight ruby"><code><span class="n">control</span> <span class="s1">'check-perl'</span> <span class="k">do</span>
  <span class="n">impact</span> <span class="mf">0.3</span>
  <span class="n">title</span> <span class="s1">'Check perl compiled options and permissions'</span>
  <span class="n">perl_out</span> <span class="o">=</span> <span class="n">command</span><span class="p">(</span><span class="s1">'perl -V'</span><span class="p">)</span>
  <span class="c1">#require 'pry'; binding.pry;</span>
  <span class="n">describe</span> <span class="n">perl_out</span> <span class="k">do</span>
    <span class="n">its</span><span class="p">(</span><span class="s1">'exit_status'</span><span class="p">)</span> <span class="p">{</span> <span class="n">should</span> <span class="n">eq</span> <span class="mi">0</span> <span class="p">}</span>
    <span class="n">its</span><span class="p">(</span><span class="s1">'stdout'</span><span class="p">)</span> <span class="p">{</span> <span class="n">should</span> <span class="n">match</span> <span class="p">(</span><span class="sr">/USE_64_BIT_ALL/</span><span class="p">)</span> <span class="p">}</span>
    <span class="n">its</span><span class="p">(</span><span class="s1">'stdout'</span><span class="p">)</span> <span class="p">{</span> <span class="n">should</span> <span class="n">match</span> <span class="p">(</span><span class="sr">/useposix=true/</span><span class="p">)</span> <span class="p">}</span>
    <span class="n">its</span><span class="p">(</span><span class="s1">'stdout'</span><span class="p">)</span> <span class="p">{</span> <span class="n">should</span> <span class="n">match</span> <span class="p">(</span><span class="sr">/-fstack-protector/</span><span class="p">)</span> <span class="p">}</span>
  <span class="k">end</span>

  <span class="c1"># extract an array of include directories</span>
  <span class="n">perl_inc</span> <span class="o">=</span> <span class="n">perl_out</span><span class="p">.</span><span class="nf">stdout</span><span class="p">.</span><span class="nf">partition</span><span class="p">(</span><span class="s1">'@INC:'</span><span class="p">).</span><span class="nf">last</span><span class="p">.</span><span class="nf">strip</span><span class="p">.</span><span class="nf">split</span><span class="p">(</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
  <span class="c1"># ensure include directories are only writable by 'owner'</span>
  <span class="n">perl_inc</span><span class="p">.</span><span class="nf">each</span> <span class="k">do</span> <span class="o">|</span><span class="n">path</span><span class="o">|</span>
    <span class="n">describe</span> <span class="n">directory</span><span class="p">(</span><span class="n">path</span><span class="p">.</span><span class="nf">strip</span><span class="p">)</span> <span class="k">do</span>
      <span class="n">it</span> <span class="p">{</span> <span class="n">should_not</span> <span class="n">be_writable</span><span class="p">.</span><span class="nf">by</span><span class="p">(</span><span class="s1">'group'</span><span class="p">)</span> <span class="p">}</span>
      <span class="n">it</span> <span class="p">{</span> <span class="n">should_not</span> <span class="n">be_writable</span><span class="p">.</span><span class="nf">by</span><span class="p">(</span><span class="s1">'other'</span><span class="p">)</span> <span class="p">}</span>
    <span class="k">end</span>
  <span class="k">end</span>
<span class="k">end</span>
</code></pre></div>
<p>An <strong>advanced</strong> but very useful Ruby tip. In the previous example, I
commented out the <code>require &#39;pry&#39;; binding.pry;</code> line. If you remove the
<code>#</code> prefix and run the control, the execution will stop at that line and
give you a <code>pry</code> shell. Use that to troubleshoot, print variables, see
methods available, etc. For the above example:</p>
<div class="highlight"><pre class="highlight ruby"><code><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="n">pry</span><span class="o">&gt;</span> <span class="n">perl_out</span><span class="p">.</span><span class="nf">exit_status</span>
<span class="o">=&gt;</span> <span class="mi">0</span>
<span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="n">pry</span><span class="o">&gt;</span> <span class="n">perl_out</span><span class="p">.</span><span class="nf">stderr</span>
<span class="o">=&gt;</span> <span class="s2">""</span>
<span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="n">pry</span><span class="o">&gt;</span> <span class="n">ls</span> <span class="n">perl_out</span>
<span class="no">Inspec</span><span class="o">::</span><span class="no">Plugins</span><span class="o">::</span><span class="no">Resource</span><span class="c1">#methods: inspect</span>
<span class="no">Inspec</span><span class="o">::</span><span class="no">Resources</span><span class="o">::</span><span class="no">Cmd</span><span class="c1">#methods: command  exist?  exit_status  result  stderr  stdout  to_s</span>
<span class="no">Inspec</span><span class="o">::</span><span class="no">Resource</span><span class="o">::</span><span class="no">Registry</span><span class="o">::</span><span class="no">Command</span><span class="c1">#methods: inspec</span>
<span class="n">instance</span> <span class="ss">variables: </span><span class="vi">@__backend_runner__</span>  <span class="vi">@__resource_name__</span>  <span class="vi">@command</span>  <span class="vi">@result</span>
<span class="p">[</span><span class="mi">4</span><span class="p">]</span> <span class="n">pry</span><span class="o">&gt;</span> <span class="n">perl_out</span><span class="p">.</span><span class="nf">stdout</span><span class="p">.</span><span class="nf">partition</span><span class="p">(</span><span class="s1">'@INC:'</span><span class="p">).</span><span class="nf">last</span><span class="p">.</span><span class="nf">strip</span><span class="p">.</span><span class="nf">split</span><span class="p">(</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
<span class="o">=&gt;</span> <span class="p">[</span><span class="s2">"/Library/Perl/5.18/darwin-thread-multi-2level"</span><span class="p">,</span>
 <span class="s2">"    /Library/Perl/5.18"</span><span class="p">,</span>
<span class="o">...</span><span class="no">REDACTED</span><span class="o">...</span>
<span class="p">[</span><span class="mi">5</span><span class="p">]</span> <span class="n">pry</span><span class="o">&gt;</span> <span class="nb">exit</span>    <span class="c1"># or abort</span>
</code></pre></div>
<p>You can use <code>pry</code> inside both the controls DSL and resources. Similarly,
for dev and test, you can use <code>inspec shell</code> which is based on <code>pry</code>,
for example:</p>
<div class="highlight"><pre class="highlight ruby"><code><span class="err">$</span> <span class="n">inspec</span> <span class="n">shell</span>
<span class="no">Welcome</span> <span class="n">to</span> <span class="n">the</span> <span class="n">interactive</span> <span class="no">InSpec</span> <span class="no">Shell</span>
<span class="no">To</span> <span class="n">find</span> <span class="n">out</span> <span class="n">how</span> <span class="n">to</span> <span class="n">use</span> <span class="n">it</span><span class="p">,</span> <span class="ss">type: </span><span class="n">help</span>

<span class="n">inspec</span><span class="o">&gt;</span> <span class="n">command</span><span class="p">(</span><span class="s1">'ls /home/gordon/git/inspec/docs'</span><span class="p">).</span><span class="nf">stdout</span>
<span class="o">=&gt;</span> <span class="s2">"ctl_inspec.rst</span><span class="se">\n</span><span class="s2">dsl_inspec.rst</span><span class="se">\n</span><span class="s2">dsl_resource.rst</span><span class="se">\n</span><span class="s2">"</span>
<span class="n">inspec</span><span class="o">&gt;</span> <span class="n">command</span><span class="p">(</span><span class="s1">'ls'</span><span class="p">).</span><span class="nf">stdout</span><span class="p">.</span><span class="nf">split</span><span class="p">(</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
<span class="o">=&gt;</span> <span class="p">[</span><span class="s2">"ctl_inspec.rst"</span><span class="p">,</span> <span class="s2">"dsl_inspec.rst"</span><span class="p">,</span> <span class="s2">"dsl_resource.rst"</span><span class="p">]</span>

<span class="n">inspec</span><span class="o">&gt;</span> <span class="n">help</span> <span class="n">command</span>
<span class="no">Name</span><span class="p">:</span> <span class="n">command</span>

<span class="no">Description</span><span class="p">:</span>
<span class="no">Use</span> <span class="n">the</span> <span class="n">command</span> <span class="no">InSpec</span> <span class="n">audit</span> <span class="n">resource</span> <span class="n">to</span> <span class="nb">test</span> <span class="n">an</span> <span class="n">arbitrary</span> <span class="n">command</span> <span class="n">that</span> <span class="n">is</span> <span class="n">run</span> <span class="n">on</span> <span class="n">the</span> <span class="nb">system</span><span class="o">.</span>

<span class="no">Example</span><span class="p">:</span>
<span class="n">describe</span> <span class="n">command</span><span class="p">(</span><span class="s1">'ls -al /'</span><span class="p">)</span> <span class="k">do</span>
  <span class="n">it</span> <span class="p">{</span> <span class="n">should</span> <span class="n">exist</span> <span class="p">}</span>
  <span class="n">its</span><span class="p">(</span><span class="s1">'stdout'</span><span class="p">)</span> <span class="p">{</span> <span class="n">should</span> <span class="n">match</span> <span class="sr">/bin/</span> <span class="p">}</span>
  <span class="n">its</span><span class="p">(</span><span class="s1">'stderr'</span><span class="p">)</span> <span class="p">{</span> <span class="n">should</span> <span class="n">eq</span> <span class="s1">''</span> <span class="p">}</span>
  <span class="n">its</span><span class="p">(</span><span class="s1">'exit_status'</span><span class="p">)</span> <span class="p">{</span> <span class="n">should</span> <span class="n">eq</span> <span class="mi">0</span> <span class="p">}</span>
<span class="k">end</span>
</code></pre></div>
<h2 id="shelling-out-in-tests">Shelling out in tests</h2>

<p>When writing tests you can not use standard ruby methods to shellout as it tries to execute those commands locally.
However, the <code>command</code> resource has a <code>.stdout</code> method that will allow you to manipulate the results.
Using the above example, you could check the writes on several subdirectories.</p>

<h3 id="example-1">Example 1:</h3>
<div class="highlight"><pre class="highlight ruby"><code><span class="err">$</span> <span class="n">inspec</span> <span class="n">shell</span>
<span class="no">Welcome</span> <span class="n">to</span> <span class="n">the</span> <span class="n">interactive</span> <span class="no">InSpec</span> <span class="no">Shell</span>
<span class="no">To</span> <span class="n">find</span> <span class="n">out</span> <span class="n">how</span> <span class="n">to</span> <span class="n">use</span> <span class="n">it</span><span class="p">,</span> <span class="ss">type: </span><span class="n">help</span>

<span class="n">inspec</span><span class="o">&gt;</span> <span class="n">output</span><span class="o">=</span><span class="n">command</span><span class="p">(</span><span class="s1">'echo test'</span><span class="p">).</span><span class="nf">stdout</span>
<span class="o">=&gt;</span> <span class="s2">"test</span><span class="se">\n</span><span class="s2">"</span>
<span class="n">inspec</span><span class="o">&gt;</span> <span class="n">describe</span> <span class="n">command</span><span class="p">(</span><span class="s1">'echo test'</span><span class="p">)</span> <span class="k">do</span>
<span class="n">inspec</span><span class="o">&gt;</span>   <span class="n">its</span><span class="p">(</span><span class="s1">'stdout'</span><span class="p">)</span> <span class="p">{</span> <span class="n">should</span> <span class="n">eq</span> <span class="n">output</span> <span class="p">}</span>
<span class="n">inspec</span><span class="o">&gt;</span> <span class="k">end</span>

<span class="no">Profile</span><span class="p">:</span> <span class="n">inspec</span><span class="o">-</span><span class="n">shell</span>
<span class="no">Version</span><span class="p">:</span> <span class="p">(</span><span class="n">not</span> <span class="n">specified</span><span class="p">)</span>

  <span class="no">Command</span> <span class="n">echo</span>
     <span class="err">✔</span>  <span class="nb">test</span> <span class="n">stdout</span> <span class="n">should</span> <span class="n">eq</span> <span class="s2">"test</span><span class="se">\n</span><span class="s2">"</span>

<span class="no">Test</span> <span class="no">Summary</span><span class="p">:</span> <span class="mi">1</span> <span class="n">successful</span><span class="p">,</span> <span class="mi">0</span> <span class="n">failures</span><span class="p">,</span> <span class="mi">0</span> <span class="n">skipped</span>
</code></pre></div>
<h3 id="example-2">Example 2:</h3>
<div class="highlight"><pre class="highlight ruby"><code><span class="err">$</span> <span class="n">inspec</span> <span class="n">shell</span>
<span class="no">Welcome</span> <span class="n">to</span> <span class="n">the</span> <span class="n">interactive</span> <span class="no">InSpec</span> <span class="no">Shell</span>
<span class="no">To</span> <span class="n">find</span> <span class="n">out</span> <span class="n">how</span> <span class="n">to</span> <span class="n">use</span> <span class="n">it</span><span class="p">,</span> <span class="ss">type: </span><span class="n">help</span>

<span class="n">inspec</span><span class="o">&gt;</span> <span class="n">dirs</span> <span class="o">=</span> <span class="n">command</span><span class="p">(</span><span class="s1">'ls -d /home/gordon/git/inspec/docs'</span><span class="p">).</span><span class="nf">stdout</span><span class="p">.</span><span class="nf">split</span><span class="p">(</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
<span class="o">=&gt;</span> <span class="p">[</span><span class="s2">"/home/gordon/git/inspec/docs"</span><span class="p">]</span>
<span class="n">inspec</span><span class="o">&gt;</span> <span class="n">dirs</span><span class="p">.</span><span class="nf">each</span> <span class="k">do</span> <span class="o">|</span><span class="n">dir</span><span class="o">|</span>
<span class="n">inspec</span><span class="o">&gt;</span>   <span class="n">describe</span> <span class="n">directory</span><span class="p">(</span><span class="n">dir</span><span class="p">)</span> <span class="k">do</span>
<span class="n">inspec</span><span class="o">&gt;</span>     <span class="n">its</span><span class="p">(</span><span class="s1">'mode'</span><span class="p">)</span> <span class="p">{</span> <span class="n">should</span> <span class="n">cmp</span> <span class="s1">'0775'</span> <span class="p">}</span>
<span class="n">inspec</span><span class="o">&gt;</span>   <span class="k">end</span>
<span class="n">inspec</span><span class="o">&gt;</span> <span class="k">end</span>

<span class="no">Profile</span><span class="p">:</span> <span class="n">inspec</span><span class="o">-</span><span class="n">shell</span>
<span class="no">Version</span><span class="p">:</span> <span class="p">(</span><span class="n">not</span> <span class="n">specified</span><span class="p">)</span>

  <span class="no">File</span> <span class="sr">/home/</span><span class="n">gordon</span><span class="o">/</span><span class="n">git</span><span class="o">/</span><span class="n">inspec</span><span class="o">/</span><span class="n">docs</span><span class="o">/</span>
     <span class="err">✔</span>  <span class="n">mode</span> <span class="n">should</span> <span class="n">cmp</span> <span class="o">==</span> <span class="s2">"0775"</span>

<span class="no">Test</span> <span class="no">Summary</span><span class="p">:</span> <span class="mi">1</span> <span class="n">successful</span><span class="p">,</span> <span class="mi">0</span> <span class="n">failures</span><span class="p">,</span> <span class="mi">0</span> <span class="n">skipped</span>
</code></pre></div></column><div class="scrollToTop shadow-dark"><img id="scrollup" onerror="this.src='/images/home/arrow.png'" src="/images/home/arrow.svg" /></div></div><script>// Swiftype JS code snippet
(function(w,d,t,u,n,s,e){w['SwiftypeObject']=n;w[n]=w[n]||function(){
(w[n].q=w[n].q||[]).push(arguments);};s=d.createElement(t);
e=d.getElementsByTagName(t)[0];s.async=1;s.src=u;e.parentNode.insertBefore(s,e);
})(window,document,'script','//s.swiftypecdn.com/install/v2/st.js','_st');

_st('install','xzyJV6P7pgscygGyyTm8','2.0.0');
// end Swiftype code snippet

document.getElementsByClassName("st-default-search-input")[0].focus();</script></main></div><footer class="dark-bg" id="main-footer"><div class="strict-center" id="dlmsg"><div class="pad-under-xs"><img alt="image of octagon spinning" id="hex" onerror="this.src='/images/octagon.png'" src="/images/octagon.svg" /></div><h3 class="t-white pad-under-xs">Get started with InSpec and rock on.</h3><div class="row align columns"><div class="strict-center"><a class="button btn-lg btn-purple shadow-dark margin-right-xs mobile-row-btn" href="/downloads"><i class="fa fa-cloud-download"></i><span>download inspec 2.0</span></a><a class="button btn-lg btn-white-o shadow-dark mobile-row-btn" href="/tutorials">browse tutorials</a></div></div></div><div class="flex align"><div class="columns large-4 medium-4 mobile-hide"><ul class="footer--logos"><li><a class="footer--logo inspec" href="/"><img alt="logo for InSpec" src="/images/inspec-by-chef-logo.png" /></a></li><li><a class="footer--logo chef" href="http://www.chef.io"><img alt="logo for Chef Software" src="/images/chef-logo.png" /></a></li></ul></div><div class="columns large-8 medium-8"><ul class="footer--links strict-right"><li><a class="link footer--link" href="/legal/licensing">Licensing</a></li><li><a class="link footer--link" href="/legal/terms-and-conditions">Terms &amp; Conditions</a></li><li><a class="link footer--link" href="/legal/trademark-policy">Trademark Policy</a></li><li><a class="link footer--link" href="/legal/privacy-policy">Privacy Policy</a></li></ul><div class="columns margin-both-xs mobile-show"><ul class="footer--logos"><li><a class="footer--logo inspec" href="/"><img alt="logo for InSpec" src="/images/inspec-by-chef-logo.png" /></a></li><li><a class="footer--logo chef" href="http://www.chef.io"><img alt="logo for Chef Software" src="/images/chef-logo.png" /></a></li></ul></div></div></div><p class="strict-center pad-under-xs"><small class="t-gray">&copy; Chef Software 2015-2018</small></p></footer><script src="https://buttons.github.io/buttons.js"></script><script src="/scripts/inspec_tutorial.js"></script><script src="/dist/inspec_tutorial.js"></script><script src="/javascripts/vendor/jquery.min.js"></script><script src="https://s3.amazonaws.com/menumaker/menumaker.min.js"></script><div class="inspec-tutorial" hidden="true" inspec-tutorial="true">Loading</div><script src="/javascripts/all.js"></script><script>//initiate sticky sidebar from jquery.sticky.js

 if (window.innerWidth > 640) { //don't fix on mobile
   $('#sidebar').stick_in_parent();
 }</script><script>function initSlideGroup(group) {
  var prev = -1;
  var links = $(group).find('a')

  links.click(function(e) {
    e.stopPropagation()

    links.removeClass('selected')
    $(this).addClass('selected')

    var idx = $(this).index();
    if(prev == idx) return;
    prev = idx;

    $('.slider .view.slide-in').removeClass('slide-in').addClass('slide-out')
    var el = $('.slider .view')[idx]
    if(el == null) {
      console.log("No element for slider index "+idx)
      return
    }

    $(el).removeClass('slide-out').removeClass('hidden').addClass('slide-in')
  })

  if(links[0] != null) links[0].click();
}

function initSliders() {
  $('.slider .view').addClass('hidden')
  var groups = $('.slider .selectors')
  groups.each(function(idx){
    initSlideGroup(this)
  })
}

//run code colors

$(document).ready(function() {
  initSliders()
  $('pre code').each(function(i, block) {
    hljs.highlightBlock(block);
  });
});

//copy to clipboard

function copyToClipboard(element) {
  var $temp = $("<input>");
  $("body").append($temp);
  $temp.val($(element).text()).select();
  document.execCommand("copy");
  $temp.remove();
}

$('#copy').hover(function() {
   $('#install').toggleClass("text-focus");
});

$('#copy').click(function() {
   $(this).removeClass("fa-copy");
   $(this).addClass("fa-check");

 setTimeout(() => {
   $(this).removeClass('fa-check').addClass('fa-copy');
  }, 1500);
});

// homepage content slider

$(function() {
  $("#expand").hide();
  $("#expandBtn").html("Show all new InSpec 2.0 features");

   $('#expandBtn').click(function() {
      $('#expand').slideToggle("fast");
      $(this).html($(this).html() == 'Collapse new InSpec 2.0 features' ? 'Show all new InSpec 2.0 features' : 'Collapse new InSpec 2.0 features');
   });
});

// tutorial content slider

$(function() {
  $(".collapseContent").hide();
  $(".collapsebtn").addClass("fa-plus-square");

   $('.collapseToggle').click(function() {
      var el = $(this).parent().find('.collapseContent')
      el.slideToggle("fast")
      // $('.collapseContent').slideToggle("fast");
      var btn = $(this).find('.collapsebtn')
      if(btn.hasClass('fa-minus-square')) {
        btn.addClass('fa-plus-square')
        btn.removeClass('fa-minus-square')
      } else {
        btn.addClass('fa-minus-square')
        btn.removeClass('fa-plus-square')
      }
   });
});



// scroll spy animations

var $slide_left = $('.slide-left');
var $slide_right = $('.slide-right');
var $slide_up = $('.slide-up');
var $slide_up_slow = $('.slide-up-slow');
var $window = $(window);

function check_if_in_view() {
  var window_height = $window.height();
  var window_top_position = $window.scrollTop();
  var window_bottom_position = (window_top_position + window_height);

  $.each($slide_left, function() {
    var $element = $(this);
    var element_height = $element.outerHeight();
    var element_top_position = $element.offset().top;
    var element_bottom_position = (element_top_position + element_height);

    //check to see if this current container is within viewport
    if ((element_bottom_position >= window_top_position) &&
        (element_top_position <= window_bottom_position)) {
      $element.addClass('in-view');
    } else {
      $element.removeClass('in-view');
    }
  });

  $.each($slide_right, function() {
    var $element = $(this);
    var element_height = $element.outerHeight();
    var element_top_position = $element.offset().top;
    var element_bottom_position = (element_top_position + element_height);

    //check to see if this current container is within viewport
    if ((element_bottom_position >= window_top_position) &&
        (element_top_position <= window_bottom_position)) {
      $element.addClass('in-view');
    } else {
      $element.removeClass('in-view');
    }
  });

  $.each($slide_up, function() {
    var $element = $(this);
    var element_height = $element.outerHeight();
    var element_top_position = $element.offset().top;
    var element_bottom_position = (element_top_position + element_height);

    //check to see if this current container is within viewport
    if ((element_bottom_position >= window_top_position) &&
        (element_top_position <= window_bottom_position)) {
      $element.addClass('in-view');
    } else {
      $element.removeClass('in-view');
    }
  });

  $.each($slide_up_slow, function() {
    var $element = $(this);
    var element_height = $element.outerHeight();
    var element_top_position = $element.offset().top;
    var element_bottom_position = (element_top_position + element_height);

    //check to see if this current container is within viewport
    if ((element_bottom_position >= window_top_position) &&
        (element_top_position <= window_bottom_position)) {
      $element.addClass('in-view');
    } else {
      $element.removeClass('in-view');
    }
  });
}

$window.on('scroll resize', check_if_in_view);
$window.trigger('scroll');

//scroll to top
$(document).ready(function(){

  $(window).scroll(function(){
    if ($(this).scrollTop() > 100) {
      $('.scrollToTop').fadeIn();
    } else {
      $('.scrollToTop').fadeOut();
    }
  });

  $('.scrollToTop').click(function(){
    $('html, body').animate({scrollTop : 0},800);
    return false;
  });

  // scrolling to resource sections
  $(".resources-button").click(function() {
    var dst = $(this).attr("href")
    $(".resources-button").removeClass("btn-purple").addClass("btn-purple-o")
    $(this).addClass("btn-purple").removeClass("btn-purple-o")
    $("html, body").animate({
        scrollTop: $(dst).offset().top - 105
    }, 1000);
  });

});

//scrolling code box

var div = $('#scrolled');
   setInterval(function(){
    var pos = div.scrollTop();
    div.scrollTop(pos + 2);
}, 200);

//Animating progress bar for header

$(document).ready(function(){

var getMax = function(){
    return $(document).height() - $(window).height();
}

var getValue = function(){
    return $(window).scrollTop();
}

if('max' in document.createElement('progress')){
    // Browser supports progress element
    var progressBar = $('progress');

    // Set the Max attr for the first time
    progressBar.attr({ max: getMax() });

    $(document).on('scroll', function(){
        // On scroll only Value attr needs to be calculated
        progressBar.attr({ value: getValue() });
    });

    $(window).resize(function(){
        // On resize, both Max/Value attr needs to be calculated
        progressBar.attr({ max: getMax(), value: getValue() });
    });
}
else {
    var progressBar = $('.progress-bar'),
        max = getMax(),
        value, width;

    var getWidth = function(){
        // Calculate width in percentage
        value = getValue();
        width = (value/max) * 100;
        width = width + '%';
        return width;
    }

    var setWidth = function(){
        progressBar.css({ width: getWidth() });
    }

    $(document).on('scroll', setWidth);
    $(window).on('resize', function(){
        // Need to reset the Max attr
        max = getMax();
        setWidth();
    });
    }
  });</script><script>$(document).foundation();
$('.try-demo').click(function(event){
  event.stopPropagation();
  $('.inspec-tutorial').show()
  window.dispatchEvent(new Event('resizeTerminal'));
  $('.quit-inspec-tutorial').click(function(event){
    event.stopPropagation();
    $('.inspec-tutorial').hide()
  })
});</script><script src="/javascripts/segment.js"></script></body></html>